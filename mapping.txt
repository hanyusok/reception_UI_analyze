# UI 요소와 SQL 쿼리 매핑 요약 (mapping.txt)
생성일: 2025-12-18

이 문서는 map-analysis 폴더 내의 분석 결과를 바탕으로 UI 요소와 하부 SQL 로직을 정리한 것입니다.

---

### 1. 🔘 버튼 (Buttons) & 액션 매핑
| 버튼명 | 주요 액션 (Function) | 대상 테이블 | SQL 작업 (Underground SQL) |
|:---|:---|:---|:---|
| **접수** | 신규 방문 등록 및 가족 연동 | FAMILY, PERSON, MASTERAUX | INSERT INTO FAMILY, UPDATE PERSON SET FCODE..., INSERT INTO MASTERAUX |
| **수정** | 수진자 인적사항 변경 | PERSON | UPDATE PERSON SET PNAME, PBIRTH, PIDNUM, SEX... WHERE PCODE = :Pcode |
| **기록** | 진료 보조 정보 업데이트 | MASTERAUX | UPDATE MASTERAUX SET PIDNUM, PNAME, CHK, SPCODE... |
| **삭제** | 환자/카드/계측 정보 삭제 | PERSON, CARD, CHECKPERSON | DELETE FROM [TABLE] WHERE PCODE = :Pcode |
| **새가족** | 신규 가족 코드 생성 | FAMILY, LAST | INSERT INTO FAMILY (FCODE), UPDATE LAST SET FCODE = :Fcode |
| **신체계측** | Vital Sign(신체정보) 저장 | CHECKPERSON | UPDATE CHECKPERSON SET WEIGHT, HEIGHT, TEMPERATUR... |
| **수납** | 수납 처리 및 미수 관리 | FEELOG | UPDATE FEELOG SET MISU, WHANBUL, WHANSU... |
| **접종** | 예방접종 기록 삭제/관리 | VAX2 | DELETE FROM VAX2 WHERE PCODE = :Pcode |

---

### 2. 📋 리스트 (Lists/Grids) & 데이터 소스
| 리스트/그리드명 | 데이터 소스 (Table) | 주요 표시 컬럼 (Label/Field) | 조회 방식 (추정) |
|:---|:---|:---|:---|
| **수진자 검색 결과** | PERSON | 개인번호, 수진자명, 생년월일, 주민번호 | SELECT * FROM PERSON WHERE PNAME LIKE :keyword |
| **가족명단** | FAMILY + PERSON | 가족번호, 관계, 수진자명, 주민번호 | SELECT * FROM PERSON WHERE FCODE = :fcode |
| **수납대장** | FEELOG | 내원일자, 본인부담, 비급여, 미수금 | SELECT * FROM FEELOG WHERE PCODE = :pcode ORDER BY VISIDATE |
| **진료기록/대기** | MASTERAUX, WAIT | 접수번호, 진단명, 처방번호, 대기순번 | SELECT * FROM MASTERAUX WHERE PCODE = :pcode |
| **보험카드 리스트** | CARD | 증번호, 조합명, 유효기간, 세대주 | SELECT * FROM CARD WHERE PCODE = :pcode |

---

### 3. 🏷️ 레이블 및 입력 필드 (Labels/Inputs)
| 카테고리 | UI 레이블 (Label) | DB 필드 (Column) | 테이블 |
|:---|:---|:---|:---|
| **인적사항** | 수진자명, 생년월일, 주민번호, 성별 | PNAME, PBIRTH, PIDNUM, SEX | PERSON |
| **가족/카드** | 세대주명, 관계, 증번호, 적용기간 | FNAME, RELATION, CARDNUM, BEGINDATE | CARD, PERSON |
| **Vital** | 체중, 키, 체온, 혈압 | WEIGHT, HEIGHT, TEMPERATUR, SYSTOLIC | CHECKPERSON |
| **진료/수납** | 접수번호, 진단명, 미수금, 요양비 | ACCEPTNUM, DX2, MISU, CAREFEE | FEELOG, MASTERAUX |

---

### 4. 🛠️ 핵심 Underground SQL 코드 스니펫

**환자 정보 업데이트 (수정 버튼)**
```sql
UPDATE PERSON SET PNAME = :Pname, PBIRTH = :Pbirth, PIDNUM = :Pidnum, 
SEX = :Sex, RELATION = :Relation, AGREE = :Agree WHERE PCODE = :Pcode
```

**접수 정보 초기화 (취소/변경 시)**
```sql
UPDATE MASTERAUX SET ACCEPT = NULL, ACCEPTNUM = NULL, ACCEPTNUM2 = NULL, 
SELFEE2 = NULL, REQCAREFEE2 = NULL, ERRCODE = NULL WHERE PCODE = :Pcode
```

**가족 코드 생성 및 시퀀스 관리 (새가족 버튼)**
```sql
INSERT INTO FAMILY (FCODE) VALUES (:Fcode);
UPDATE LAST SET FCODE = :Fcode;
```

